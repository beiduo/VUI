VUI.dialog=function(e,t){if(typeof e.before=="function"&&!e.before())return typeof e.error=="function"&&e.error(),!1;!e.id&&e.mask!=="yes"?e.id="common":e.id=e.id||VUI.getId();if((!e.button||e.button.length<1)&&!e.nobutton&&typeof e.icon=="string"){if(e.icon==="ok"||e.icon==="error")e.button=[{classname:"btn-positive",value:"确定",type:"close"}];e.icon==="alert"&&(e.button=[{classname:"btn-positive",value:"确定",type:"confirm"},{value:"取消",type:"close"}])}if(typeof t!="undefined")var n=objectPlus(t,e);else var n=objectPlus(VUI.dialog.defaults,e);return n.create(),n},VUI.dialog.defaults={tplMsg:function(e){var t='<table class="withicon icon-'+this.icon+'""><tr>'+'<td class="icon" style="vertical-align:'+(this.iconVlign||"middle")+';"><i>&nbsp;</i></td>'+'<td class="text" style="vertical-align:'+(this.iconVlign||"middle")+';">'+e+"</td>"+"</tr></table>";return t},setContent:function(){var e,t,n,r=VUI.q("div.vui-dialog-content",this.node)[0],i=this;if(typeof this.append=="string"&&this.append!==""&&VUI.q(this.append).length!==0){n=VUI.q(this.append);for(e=0;e<n.length;e++)r.appendChild(n[e])}else if(typeof this.clone=="string"&&this.clone!==""&&VUI.q(this.clone).length!==0){n=VUI.q(this.clone);for(e=0;e<n.length;e++)r.appendChild(n[e].cloneNode(!0))}else if(typeof this.source=="string"&&this.source!==""){t="";try{VUI.ajax({url:this.source,cache:!1,success:function(e){r.innerHTML=e,i.position()},error:function(e,t){r.innerHTML="出错了，错误信息："+e+", 状态"+t,i.position()}})}catch(s){}}else typeof this.icon=="string"&&this.icon!==""?(t=this.content?this.content:"",r.innerHTML=this.tplMsg(t)):(t=this.content?this.content:"",r.innerHTML=t);return this},setButton:function(){if(!this.button||this.button.length<1)return this;var e,t=this.button,n=document.createElement("div");n.className="dfoot";var r=document.createElement("div");r.className="clearfix inner";var i=[];for(e=0;e<t.length;e++)i[e]=document.createElement("a"),i[e].id=t[e].id||"",i[e].className="btnwrap "+(t[e].classname||""),i[e].href="javascript:void(0);",i[e].innerHTML=t[e].value||"",typeof t[e].type=="string"?(t[e].type==="close"&&addEvent(i[e],"click",this.close.bind(this,this.close)),t[e].type==="confirm"&&addEvent(i[e],"click",this.confirm.bind(this,this.confirm)),t[e].type==="submit"&&addEvent(i[e],"click",this.submit.bind(this,this.submit))):typeof t[e].callback=="function"&&addEvent(i[e],"click",t[e].callback),r.appendChild(i[e]);return n.appendChild(r),this.node.children[0].appendChild(n),this},css:function(){return typeof this.fontSize=="string"&&(VUI.q("div.vui-dialog-content",this.node)[0].style.fontSize=this.fontSize),this.node.style.width=this.width||"auto",VUI.testIE()<=6&&(!this.width==="string"||isNaN(parseInt(this.width)))&&(this.node.children[0].style.width="420px"),this.node.style.left="50%",this.position(),this.node.style.display="block",this},position:function(){var e=getFullHeight(this.node),t=getFullWidth(this.node);VUI.testIE()<=6?(this.node.style.position="absolute",this.node.style.top=Math.max((getWindowHeight()-e)/2+document.documentElement.scrollTop,0)+"px"):this.node.style.top=Math.max(getWindowHeight()-e,0)/2+"px",this.node.style.marginLeft=Math.floor(-t/2)+"px"},tpl:function(){var e='<div class="dwarp"><div class="dhead"><h2 class="title"><span class="inner">'+(this.title?this.title:"对话框")+"</span></h2>"+'<div class="extra">'+(this.shut==="no"?"":'<a class="vui-dialog-close" href="javascript:void(0)">关闭</a>')+"</div>"+"</div>"+'<div class="dbody" style="padding:'+(this.padding||"10px")+'"><div class="clearfix vui-dialog-content">'+"</div></div>"+"</div>";return e},create:function(){this.mask==="yes"&&VUI.mask();var e=document.getElementById("vui-dialog-"+this.id);e&&e.parentNode.removeChild(e);var t=document.createElement("div");t.id="vui-dialog-"+this.id,t.className="vui-dialog"+(this.skin?" vui-dialog-"+this.skin:""),t.style.display="none",t.innerHTML=this.tpl();var n=document.body.appendChild(t);return this.node=n,this.setContent().setButton().events().css(),this},events:function(){var e=VUI.q("a.vui-dialog-close",this.node);return e.length>0&&addEvent(e[0],"click",this.close.bind(this,this.close)),this},close:function(){this.node.parentNode.removeChild(this.node);var e=document.getElementById("vui-mask");return e&&e.parentNode.removeChild(e),!1},confirm:function(){return!0},submit:function(){this.node.getElementsByTagNames("form")[0].submit()}}