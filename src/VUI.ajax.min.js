function createXHR(){if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined"){if(typeof arguments.callee.activeXString!="string"){var e=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHtt++p"];for(var t=0,n=e.length;t<n;t++)try{var r=new ActiveXObject(e[t]);return arguments.callee.activeXString=e[t],r}catch(i){}}return new ActiveXObject(arguments.callee.activeXString)}throw new Error("No XHR object available")}VUI.ajax=function(e,t){if(typeof e.before=="function"&&!e.before())return!1;if(typeof t!="undefined")var n=objectPlus(t,e);else var n=objectPlus(VUI.ajax.defaults,e);var r=n.create();return r},VUI.ajax.defaults={method:"get",dataType:"text",cache:!0,create:function(){var _this=this,url=typeof this.url=="string"?this.url:"";url=url||window.location.href||"",url&&(url=(url.match(/^([^#]+)/)||[])[1]),this.method!=="post"&&typeof this.data=="string"&&(url+=url.indexOf("?")===-1?"?":"&",url+=this.data);var xhr=createXHR();return xhr.onreadystatechange=function(){if(xhr.readyState==4)if(xhr.status>=200&&xhr.status<300||xhr.status==304){var callback;if(_this.dataType==="xml")try{xhr.responseXML?callback=xhr.responseXML.documentElement:callback=parseXml(xhr.responseText)}catch(e){_this.error("数据返回错误",xhr.status);return}else if(_this.dataType==="json")try{callback=eval("("+xhr.responseText+")")}catch(e){_this.error("数据返回错误",xhr.status);return}else callback=xhr.responseText;_this.success(callback,xhr.status)}else _this.error("服务器错误",xhr.status)},xhr.open(this.method,url,!0),this.method==="post"?(_this.cache||xhr.setRequestHeader("If-Modified-Since","0"),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.send(this.data)):(_this.cache||xhr.setRequestHeader("If-Modified-Since","0"),xhr.send(null)),xhr},success:function(){},error:function(){}},VUI.get=function(e,t){var n=createXHR();n.onreadystatechange=function(){var e;n.readyState==4&&(n.status>=200&&n.status<300||n.status==304?e=n.responseText:e="出错了，错误代码："+n.status,t(e))},n.open("get",e,!0),n.setRequestHeader("If-Modified-Since","0"),n.send(null)}